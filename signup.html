<!DOCTYPE html>
<html>
<head>
    <title>LanguagesOnline</title>
    <style>
        /* Previous CSS remains unchanged */
        .browser-ui { max-width: 800px; margin: 20px auto; padding: 20px; }
        .url-bar { display: flex; gap: 10px; margin-bottom: 20px; }
        input[type="text"] { flex: 1; padding: 8px; }
        button { padding: 8px 20px; cursor: pointer; }
        .loading-screen { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .progress-bar { width: 200px; height: 20px; background: #ddd; position: relative; overflow: hidden; }
        .progress-bar::after { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 0; background: #4CAF50; animation: progress 2s infinite linear; }
        @keyframes progress {
            0% { width: 0; left: 0; }
            50% { width: 100%; left: 0; }
            100% { width: 0; left: 100%; }
        }
        .status-indicator { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-left: 10px; }
        .server-status { margin-bottom: 10px; }
    </style>
</head>
<body>
    <!-- Same HTML structure -->
    <script>
        const PROXY_SERVER = 'https://garfish-capital-reindeer.ngrok-free.app/proxy';
        const PING_URL = 'https://garfish-capital-reindeer.ngrok-free.app/ping';

        let currentUrl = '';
        let progressInterval;

        function normalizeUrl(url) {
            try {
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    return `https://${url}`;
                }
                return url;
            } catch {
                return `https://${url}`;
            }
        }

        function simulateProgress() {
            let current = 0;
            progressInterval = setInterval(() => {
                current = Math.min(current + (Math.random() * 3), 99);
                document.getElementById('percentage').textContent = 
                    Math.floor(current) + '%';
            }, 50);
        }

        async function checkServerStatus() { /* unchanged */ }

        function handleFrameNavigation(url) { /* unchanged */ }

        async function loadUrl() {
            let url = document.getElementById('urlInput').value;
            const loadingScreen = document.getElementById('loading');
            const frame = document.getElementById('contentFrame');
            
            if(!url) {
                alert('Please enter a URL');
                return;
            }

            url = normalizeUrl(url);
            currentUrl = url;

            loadingScreen.style.display = 'block';
            frame.style.display = 'none';
            simulateProgress();

            try {
                const proxyUrl = `${PROXY_SERVER}?url=${encodeURIComponent(url)}`;
                frame.src = proxyUrl;
                
                frame.onload = () => {
                    clearInterval(progressInterval);
                    document.getElementById('percentage').textContent = '100%';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        frame.style.display = 'block';
                    }, 200);
                    
                    try {
                        frame.contentWindow.document.querySelectorAll('a').forEach(link => {
                            link.addEventListener('click', (e) => {
                                e.preventDefault();
                                const href = link.href;
                                handleFrameNavigation(href);
                            });
                        });

                        frame.contentWindow.open = (url) => {
                            handleFrameNavigation(url);
                            return {
                                close: () => {},
                                focus: () => {}
                            };
                        };
                    } catch (error) {
                        console.log('Cross-origin frame security restriction');
                    }
                };

                frame.onerror = () => {
                    throw new Error('Failed to load content');
                };
            } catch (error) {
                console.error('Error:', error);
                clearInterval(progressInterval);
                loadingScreen.style.display = 'none';
                alert('Error loading URL: ' + error.message);
            }
        }

        window.addEventListener('load', checkServerStatus);
    </script>
</body>
</html>
