<!DOCTYPE html>
<html>
<head>
    <title>Pi Proxy</title>
    <style>
        body { margin: 20px; font-family: Arial; }
        .container { max-width: 800px; margin: 0 auto; }
        input[type="text"] { width: 70%; padding: 8px; }
        button { padding: 8px 15px; background: #4CAF50; color: white; border: none; cursor: pointer; }
        iframe { width: 100%; height: 80vh; border: 1px solid #ddd; margin-top: 10px; }
        .loading { 
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        .progress-bar {
            width: 200px;
            height: 4px;
            background: #ddd;
            margin: 10px auto;
        }
        .progress {
            width: 0%;
            height: 100%;
            background: #4CAF50;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <input type="text" id="urlInput" placeholder="Enter URL (e.g., example.com)">
        <button onclick="loadUrl()">GO</button>
        <div class="loading" id="loading">
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <div>Loading...</div>
        </div>
        <iframe id="contentFrame"></iframe>
    </div>

    <script>
        const PROXY_SERVER = 'https://garfish-capital-reindeer.ngrok-free.app';
        
        function updateProgress(percent) {
            document.getElementById('progress').style.width = `${percent}%`;
        }

        async function checkServer() {
            try {
                const response = await fetch(`${PROXY_SERVER}/ping`);
                alert(response.ok ? 'Server is online! ðŸŸ¢' : 'Server error ðŸ”´');
            } catch {
                alert('Server unreachable ðŸ”´');
            }
        }

        function loadUrl() {
            const url = document.getElementById('urlInput').value.trim();
            if(!url) return alert('Please enter a URL');
            
            const frame = document.getElementById('contentFrame');
            const loading = document.getElementById('loading');
            
            loading.style.display = 'block';
            updateProgress(0);
            
            // Simple progress simulation
            let progress = 0;
            const interval = setInterval(() => {
                progress = Math.min(progress + Math.random() * 10, 90);
                updateProgress(progress);
            }, 100);

            frame.onload = () => {
                clearInterval(interval);
                updateProgress(100);
                setTimeout(() => {
                    loading.style.display = 'none';
                }, 300);
            };

            frame.src = `${PROXY_SERVER}/proxy?url=${encodeURIComponent(url)}`;
        }

        // Add check server button
        document.body.insertAdjacentHTML('afterbegin', 
            `<button style="margin-bottom: 10px" onclick="checkServer()">Check Server Status</button>`
        );
    </script>
</body>
</html>
